(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3096],{5569:function(e,a,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/circular-barplot",function(){return t(740)}])},3485:function(e,a,t){"use strict";t.d(a,{U:function(){return i}});var n=t(5893),r=t(7294),i=function(e){var a=e.startOpen,t=e.title,i=e.children,s=e.toc,l=(0,r.useState)(a),o=l[0],d=l[1],c=o?"max-h-full":"max-h-0",h=o?"overflow-visible":"overflow-hidden";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h2",{className:"cursor-pointer",onClick:function(){return d(!o)},id:s,children:[o?(0,n.jsx)("span",{className:"text-purple-700 w-4 mr-2 hover:text-purple-900 inline-block",children:"-"}):(0,n.jsx)("span",{className:"text-purple-700 w-4 mr-2 hover:text-purple-900 inline-block",children:"+"}),t]}),(0,n.jsx)("div",{className:"transition-max-height ease-in duration-300  "+c+" "+h,children:i})]})}},740:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return M}});var n=t(5893),r=t(7294),i=t(1884),s=t(8807),l=t(7197),o=t(6978),d=t(3485),c=t(8193),h=t(33),u=t(1664),m=t(3440),p=[{name:"Mark",value:90},{name:"Robert",value:12},{name:"Emily",value:34},{name:"Marion",value:53},{name:"Nicolas",value:98},{name:"Mel",value:23},{name:"Gabriel",value:18},{name:"Jean",value:104},{name:"Sophie",value:14},{name:"Leane",value:74},{name:"Melanie",value:72},{name:"Tibo",value:23},{name:"Remi",value:124},{name:"Balkis",value:23},{name:"Nina",value:104},{name:"Lucas",value:94},{name:"Paul",value:2}],x=t(2989);function f(e,a){return function(e){if(Array.isArray(e))return e}(e)||function(e,a){var t=[],n=!0,r=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(n=(s=l.next()).done)&&(t.push(s.value),!a||t.length!==a);n=!0);}catch(o){r=!0,i=o}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return t}(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var v=function(e){var a=e.width,t=e.height,i=e.data,s=Math.min(a,t)/2,l=i.sort((function(e,a){return a.value-e.value})).map((function(e){return e.name})),o=(0,r.useMemo)((function(){return x.tiA().domain(l).range([0,2*Math.PI]).padding(.2)}),[i,t,a]),d=(0,r.useMemo)((function(){var e=f(x.Wem(i.map((function(e){return e.value}))),2),a=(e[0],e[1]);return x.s$j().domain([0,a||10]).range([90,s])}),[i,a,t]),c=x.Nb1(),h=i.map((function(e,a){var t=c({innerRadius:90,outerRadius:d(e.value),startAngle:o(e.name),endAngle:o(e.name)+o.bandwidth()});return(0,n.jsx)("g",{children:(0,n.jsx)("path",{d:t,opacity:.7,stroke:"#9d174d",fill:"#9d174d",fillOpacity:.3,strokeWidth:1,rx:1})},a)}));return(0,n.jsx)("div",{children:(0,n.jsx)("svg",{width:a,height:t,children:(0,n.jsx)("g",{transform:"translate("+(a/2+20)+","+(t/2+20)+")",children:h})})})},j=function(e){var a=e.width,t=void 0===a?700:a,r=e.height,i=void 0===r?400:r;return(0,n.jsx)(v,{data:p,width:t,height:i})},g=[{name:"Mark",value:90},{name:"Robert",value:12},{name:"Emily",value:34},{name:"Marion",value:53},{name:"Nicolas",value:98},{name:"Mel",value:23},{name:"Gabriel",value:18},{name:"Jean",value:104},{name:"Sophie",value:14},{name:"Leane",value:74},{name:"Melanie",value:72},{name:"Tibo",value:23},{name:"Remi",value:124},{name:"Balkis",value:23},{name:"Nina",value:104},{name:"Lucas",value:94},{name:"Paul",value:2}];function b(e,a){return function(e){if(Array.isArray(e))return e}(e)||function(e,a){var t=[],n=!0,r=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(n=(s=l.next()).done)&&(t.push(s.value),!a||t.length!==a);n=!0);}catch(o){r=!0,i=o}finally{try{n||null==l.return||l.return()}finally{if(r)throw i}}return t}(e,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var w=function(e){var a=e.width,t=e.height,i=e.data,s=Math.min(a,t)/2-50,l=i.sort((function(e,a){return a.value-e.value})).map((function(e){return e.name})),o=(0,r.useMemo)((function(){return x.tiA().domain(l).range([0,2*Math.PI]).padding(.2)}),[i,t,a]),d=(0,r.useMemo)((function(){var e=b(x.Wem(i.map((function(e){return e.value}))),2),a=(e[0],e[1]);return x.s$j().domain([0,a||10]).range([90,s])}),[i,a,t]),c=x.Nb1(),h=i.map((function(e,a){var t=c({innerRadius:90,outerRadius:d(e.value),startAngle:o(e.name),endAngle:o(e.name)+o.bandwidth()}),r=(o(e.name)+o.bandwidth()/2+Math.PI)%(2*Math.PI)<Math.PI,i="rotate("+(180*(o(e.name)+o.bandwidth()/2)/Math.PI-90)+"),translate("+(d(e.value)+10)+",0)";return(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:t,opacity:.7,stroke:"#9d174d",fill:"#9d174d",fillOpacity:.3,strokeWidth:1,rx:1}),(0,n.jsx)("g",{transform:i,children:(0,n.jsx)("text",{textAnchor:r?"end":"start",alignmentBaseline:"middle",fontSize:16,transform:r?"rotate(180)":"rotate(0)",children:e.name})})]},a)}));return(0,n.jsx)("div",{children:(0,n.jsx)("svg",{width:a,height:t,children:(0,n.jsx)("g",{transform:"translate("+a/2+","+t/2+")",children:h})})})},y=function(e){var a=e.width,t=void 0===a?700:a,r=e.height,i=void 0===r?400:r;return(0,n.jsx)(w,{data:g,width:t,height:i})},k=(0,n.jsxs)("p",{children:["A"," ",(0,n.jsx)("a",{href:"https://www.data-to-viz.com/graph/circularbarplot.html",children:"circular barplot"})," ","is the equivalent of a ",(0,n.jsx)(u.default,{href:"barplot",children:"barplot"}),", with bars displayed around a circle. This page describes how to deal with radial coordinates with ",(0,n.jsx)("code",{children:"d3.js"})," and ",(0,n.jsx)("code",{children:"react"}),". It's a step by step tutorial with several interactive sandboxes."]}),A="\nconst xScale = d3\n      .scaleBand()\n      .domain(groups)\n      .range([0, 2 * Math.PI])\n      .padding(BAR_PADDING)\n\nconst yScale = d3\n      .scaleRadial()\n      .domain([0, max])\n      .range([innerRadius, outerRadius])\n".trim(),R="\nconst arcPathGenerator = d3.arc();\n\nconst allShapes = data.map((group, i) => {\n  const path = arcPathGenerator({\n    innerRadius: innerRadius,\n    outerRadius: yScale(group.value),\n    startAngle: xScale(group.name),\n    endAngle: xScale(group.name) + xScale.bandwidth(),\n  });\n})\n".trim();function M(){return(0,n.jsxs)(i.A,{title:"Circular Barplot with React",seoDescription:"How to build a circular barplot with React and D3.js. A set of re-usable components",children:[(0,n.jsx)(s.Z,{title:"Circular Barplot",description:k,chartType:"circularBarplot"}),(0,n.jsxs)(d.U,{title:"Dataset",startOpen:!0,children:[(0,n.jsxs)("p",{children:["The dataset required to build a circular barplot is usually an array where each item is an object providing the ",(0,n.jsx)("code",{children:"name"})," and the"," ",(0,n.jsx)("code",{children:"value"})," of the group."]}),(0,n.jsx)("br",{}),(0,n.jsx)("p",{children:"Here is a minimal example"}),(0,n.jsx)(c.d,{code:A}),(0,n.jsxs)("p",{children:["Note: if your data is in ",(0,n.jsx)("code",{children:".csv"})," format, you can translate it thanks to the ",(0,n.jsx)("code",{children:"d3.csv()"})," function as suggested"," ",(0,n.jsx)("a",{href:"https://d3-graph-gallery.com/graph/barplot_horizontal.html",children:"here"}),"."]})]}),(0,n.jsxs)(d.U,{title:"Bars in radial coordinates",startOpen:!0,children:[(0,n.jsxs)("p",{children:["Even if the process to build a circular barplot is very different than for the common ",(0,n.jsx)(u.default,{href:"barplot",children:"barplot"}),", I strongly advise to have a good understanding of the common version first."," ",(0,n.jsx)(u.default,{href:"barplot",children:"Check it out"}),"."]}),(0,n.jsx)("p",{children:"Here is an overview of the main differences."}),(0,n.jsx)("h3",{children:"\u2192 Radial coordinates"}),(0,n.jsxs)("p",{children:["Do you remember you high school lectures about trigonometry? Me either \ud83d\ude43. But we need it here. Using radial coordinates, each point is defined using an ",(0,n.jsx)("b",{children:"angle"})," and its ",(0,n.jsx)("b",{children:"distance to the center"})," of the chart."]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("b",{children:"Angle"})," is defined between ",(0,n.jsx)("code",{children:"0"})," (top) and"," ",(0,n.jsx)("code",{children:"2*Pi"})," (top again). A value of ",(0,n.jsx)("code",{children:"Pi"})," will be at the bottom."]}),(0,n.jsxs)("p",{children:[(0,n.jsx)("b",{children:"Distance"})," to the center goes from ",(0,n.jsx)("code",{children:"innerRadius"})," to"," ",(0,n.jsx)("code",{children:"outerRadius"}),". The inner radius is arbitraty. Do not use something too small or your bars will be very distorded. The upper value is computed from the svg dimenstion to fill it properly."]}),(0,n.jsxs)("p",{children:["The X scale (for the groups) is a ",(0,n.jsx)("code",{children:"scaleBand"})," like for a common barplot, but it goes from ",(0,n.jsx)("code",{children:"0"})," to ",(0,n.jsx)("code",{children:"2*Pi"})," ","instead of going from ",(0,n.jsx)("code",{children:"0"})," to ",(0,n.jsx)("code",{children:"width"}),"."," "]}),(0,n.jsx)("h3",{children:"\u2192 Y Scale"}),(0,n.jsxs)("p",{children:["The Y scale uses a very specific ",(0,n.jsx)("code",{children:"scaleRadial"}),". Indeed, bars are wider at their top than at their bottom. This"," ",(0,n.jsx)("code",{children:"scaleRadial"})," takes it into account and bring some sort of correction. Check the"," ",(0,n.jsx)("a",{href:"https://github.com/d3/d3-scale#radial-scales",children:"doc"}),", or even this"," ",(0,n.jsx)("a",{href:"https://github.com/d3/d3-scale/issues/90",children:"explanation"})," for more."]}),(0,n.jsx)("p",{children:"At the end of the day, that's how our scales look like:"}),(0,n.jsx)(c.d,{code:A}),(0,n.jsxs)("h3",{children:["\u2192 Drawing with ",(0,n.jsx)("code",{children:"path"}),", not ",(0,n.jsx)("code",{children:"rect"}),"."]}),(0,n.jsxs)("p",{children:["We are not drawing rectangles here, so the svg ",(0,n.jsx)("code",{children:"rect"})," ","element won't be helpful."]}),(0,n.jsxs)("p",{children:["Instead, we are drawing ",(0,n.jsx)("b",{children:"fractions of a rings"}),", that you can call arcs."]}),(0,n.jsxs)("p",{children:["Fortunately, d3.js has an ",(0,n.jsx)("code",{children:"arc()"})," function that will generate the svg ",(0,n.jsx)("code",{children:"path"})," for us. It's the same process that is used to create a ",(0,n.jsx)(u.default,{href:"pie-plot",children:"pie chart"})," or a"," ",(0,n.jsx)(u.default,{href:"donut",children:"donut chart"}),"."]}),(0,n.jsx)("p",{children:"Here is an idea on how the function can be used to generate all the svg shapes:"}),(0,n.jsx)(c.d,{code:R}),(0,n.jsx)("h3",{children:"\u2192 Rendering"}),(0,n.jsxs)("p",{children:["Not much to add. Just include the paths in a ",(0,n.jsx)("code",{children:"svg"})," element. Remember that 0,0 is the center of the chart instead of being the top-left corner. So we need to apply a ",(0,n.jsx)("code",{children:"translate"})," at some point."]}),(0,n.jsx)(h.$,{vizName:"CircularBarplotBasic",VizComponent:j,height:500,maxWidth:600,caption:(0,n.jsxs)("span",{children:["Most basic circular barplot built with d3.js and react, using radial coordinates and ",(0,n.jsx)("code",{children:"path"})," instead of"," ",(0,n.jsx)("code",{children:"rect"}),"."]})}),(0,n.jsx)("p",{children:"That's a good start but it looks pretty much like a snail so far. Let's make it a real chart with labels and values."})]}),(0,n.jsxs)(d.U,{title:"Labels and Values",startOpen:!0,children:[(0,n.jsx)("p",{children:"Add a text element to show the name of each bar. A bit or logic to write to determine wether or not a label must be flipped, and how to position it properly."}),(0,n.jsx)(h.$,{vizName:"CircularBarplotLabel",VizComponent:y,height:500,maxWidth:600,caption:"Add some labels to each bar of the circular barchart to make it insightful"})]}),(0,n.jsx)(m.Z,{chartId:"circularBarplot"}),(0,n.jsx)(d.U,{title:"Vertical barplot",startOpen:!0,children:(0,n.jsx)("p",{children:"The vertical option is less common since it makes is much harder to read the labels. But if you really need it, it is just a matter of swaping the X and Y axes of the previous example. Here is a working version."})}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("br",{}),(0,n.jsx)("div",{className:"full-bleed border-t h-0 bg-gray-100 my-3"}),(0,n.jsx)(l.Z,{chartFamily:"partOfAWhole"}),(0,n.jsx)("div",{className:"mt-20"}),(0,n.jsx)(o.Z,{})]})}}},function(e){e.O(0,[2781,5660,358,5443,9774,2888,179],(function(){return a=5569,e(e.s=a);var a}));var a=e.O();_N_E=a}]);