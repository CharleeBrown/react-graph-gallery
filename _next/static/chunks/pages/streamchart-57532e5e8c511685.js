(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5503],{8702:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/streamchart",function(){return n(2169)}])},3485:function(e,t,n){"use strict";n.d(t,{U:function(){return i}});var r=n(5893),s=n(7294),i=function(e){var t=e.startOpen,n=e.title,i=e.children,o=e.toc,a=(0,s.useState)(t),c=a[0],h=a[1],d=c?"max-h-full":"max-h-0",l=c?"overflow-visible":"overflow-hidden";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("h2",{className:"cursor-pointer",onClick:function(){return h(!c)},id:o,children:[c?(0,r.jsx)("span",{className:"text-purple-700 w-4 mr-2 hover:text-purple-900 inline-block",children:"-"}):(0,r.jsx)("span",{className:"text-purple-700 w-4 mr-2 hover:text-purple-900 inline-block",children:"+"}),n]}),(0,r.jsx)("div",{className:"transition-max-height ease-in duration-300  "+d+" "+l,children:i})]})}},2173:function(e,t,n){"use strict";n.d(t,{r:function(){return c}});var r=n(5893),s=n(1664),i=n(1878),o=n(3359),a=n(8193),c=function(e){var t=e.chartId,n=i.c.filter((function(e){return e.id===t}))[0].label;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{id:"responsiveness",children:"Responsive "+n+" with react"}),(0,r.jsxs)("p",{children:["The component above is not responsive. It expects 2 props called"," ",(0,r.jsx)("code",{children:"width"})," and ",(0,r.jsx)("code",{children:"height"})," and will render a ",n," of those dimensions."]}),(0,r.jsxs)("p",{children:["Making the ",n," responsive requires adding a ",(0,r.jsx)("b",{children:"wrapper"})," component that gets the dimension of the parent ",(0,r.jsx)("code",{children:"div"}),", and listening to a potential dimension change. This is possible thanks to a hook called"," ",(0,r.jsx)("code",{children:"useDimensions"})," that will do the job for us."]}),(0,r.jsx)(o.U,{startOpen:!1,title:(0,r.jsxs)("span",{children:[(0,r.jsx)("code",{children:"useDimensions"}),": a hook to make your viz responsive"]}),children:(0,r.jsx)(a.d,{code:h})}),(0,r.jsxs)("p",{children:["I'm in the process of writing a complete blog post on the topic."," ",(0,r.jsx)(s.default,{href:"/subscribe",children:"Subscribe to the project"})," to know when it's ready."]}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{})]})},h='\nexport const useDimensions = (targetRef: React.RefObject<HTMLDivElement>) => {\n\n  const getDimensions = () => {\n    return {\n      width: targetRef.current ? targetRef.current.offsetWidth : 0,\n      height: targetRef.current ? targetRef.current.offsetHeight : 0\n    };\n  };\n\n  const [dimensions, setDimensions] = useState(getDimensions);\n\n  const handleResize = () => {\n    setDimensions(getDimensions());\n  };\n\n  useEffect(() => {\n    window.addEventListener("resize", handleResize);\n    return () => window.removeEventListener("resize", handleResize);\n  }, []);\n\n  useLayoutEffect(() => {\n    handleResize();\n  }, []);\n\n  return dimensions;\n}\n'.trim()},3359:function(e,t,n){"use strict";n.d(t,{U:function(){return s}});var r=n(5893),s=function(e){e.startOpen;var t=e.title,n=e.children;return(0,r.jsxs)("details",{className:"bg-gray-50 py-2 px-4 rounded-md my-2",children:[(0,r.jsx)("summary",{className:"cursor-pointer",children:t}),n]})}},2169:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var r=n(5893),s=n(7294),i=n(1884),o=n(8807),a=n(7197),c=n(6978),h=n(3485),d=n(8193),l=n(33),u=n(1664),p=n(3440),x=[{x:1,groupA:38,groupB:19,groupC:9,groupD:4},{x:2,groupA:16,groupB:14,groupC:96,groupD:40},{x:3,groupA:64,groupB:96,groupC:64,groupD:40},{x:4,groupA:32,groupB:48,groupC:64,groupD:40},{x:5,groupA:12,groupB:18,groupC:14,groupD:10}],f=n(5250);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,s=!1,i=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(c){s=!0,i=c}finally{try{r||null==a.return||a.return()}finally{if(s)throw i}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var g={top:30,right:30,bottom:50,left:50},j=function(e){var t=e.width,n=e.height,i=e.data,o=t-g.right-g.left,a=n-g.top-g.bottom,c=["groupA","groupB","groupC","groupD"],h=f.knu().keys(c).order(f.Qxt).offset(f.KuJ)(i),d=(0,s.useMemo)((function(){return f.BYU().domain([-200,200]).range([a,0])}),[i,n]),l=m(f.Wem(i,(function(e){return e.x})),2),u=l[0],p=l[1],x=(0,s.useMemo)((function(){return f.BYU().domain([u||0,p||0]).range([0,o])}),[i,t]),j=f.PKp().domain(c).range(["#e0ac2b","#e85252","#6689c6","#9a6fb0","#a53253"]),v=f.SOn().x((function(e){return x(e.data.x)})).y1((function(e){return d(e[1])})).y0((function(e){return d(e[0])})).curve(f.zgE),w=h.map((function(e,t){var n=v(e);return(0,r.jsx)("path",{d:n,opacity:1,stroke:"grey",fill:j(e.key),fillOpacity:.8},t)})),y=x.ticks(5).map((function(e,t){return(0,r.jsxs)("g",{children:[(0,r.jsx)("line",{x1:x(e),x2:x(e),y1:0,y2:a,stroke:"#808080",opacity:.2}),(0,r.jsx)("text",{x:x(e),y:a+10,textAnchor:"middle",alignmentBaseline:"central",fontSize:9,stroke:"#808080",opacity:.8,children:e})]},t)}));return(0,r.jsx)("div",{children:(0,r.jsx)("svg",{width:t,height:n,children:(0,r.jsxs)("g",{width:o,height:a,transform:"translate(".concat([g.left,g.top].join(","),")"),children:[y,w]})})})},v=function(e){var t=e.width,n=void 0===t?700:t,s=e.height,i=void 0===s?400:s;return(0,r.jsx)(j,{data:x,width:n,height:i})},w=n(2173),y=(0,r.jsxs)("p",{children:["A"," ",(0,r.jsx)("a",{href:"https://www.data-to-viz.com/graph/streamgraph.html",children:"streamgraph"})," ","is a variation of the more common"," ",(0,r.jsx)(u.default,{href:"stacked-area-plot",children:"stacked area chart"}),". This section explains how to stack and smooth the data with ",(0,r.jsx)("code",{children:"d3.js"}),", and render the shapes with ",(0,r.jsx)("code",{children:"react"}),". It starts from the basic and goes until necessary customization like tooltips, hover effect, legend and annotation, always with editable sandboxes."]}),b="\nconst data = [\n  {\n    x: 1,\n    groupA: 38,\n    groupB: 19,\n  },\n  {\n    x: 2,\n    groupA: 16,\n    groupB: 14,\n  },\n  ...\n];\n".trim(),k="\nconst stackSeries = d3\n  .stack()\n  .keys(groups)\n  .order(d3.stackOrderNone)\n  .offset(d3.stackOffsetSilhouette);\nconst series = stackSeries(data);\n".trim();"\nconst series = stackSeries(data);\n".trim();function D(){return(0,r.jsxs)(i.A,{title:"Streamchart with React",seoDescription:"How to build a stream chart with React and D3.js. A set of re-usable components",children:[(0,r.jsx)(o.Z,{title:"Streamcharts",description:y,chartType:"stream"}),(0,r.jsxs)(h.U,{title:"Dataset",startOpen:!0,children:[(0,r.jsx)("p",{children:"Most of the time the input dataset is an array where each item is an object."}),(0,r.jsxs)("p",{children:["Each object provides information for a step on the X axis. It has a value like ",(0,r.jsx)("code",{children:"x"})," that provides the exact position on the X axis. It then has several numeric values, one for each group of the dataset."]}),(0,r.jsx)("p",{children:"Here is a minimal example:"}),(0,r.jsx)(d.d,{code:b}),(0,r.jsxs)("p",{children:["Note: if your data is in ",(0,r.jsx)("code",{children:".csv"})," format, you can translate it thanks to the ",(0,r.jsx)("code",{children:"d3.csv()"})," function as suggested"," ",(0,r.jsx)("a",{href:"https://d3-graph-gallery.com/graph/line_basic.html",children:"here"}),"."]})]}),(0,r.jsxs)(h.U,{title:"Data wrangling",startOpen:!0,children:[(0,r.jsx)("p",{children:"Building a stream chart requires to stack the data. Series are displayed one on top of each other and you have to compute their positions on the Y axis."}),(0,r.jsxs)("p",{children:["Fortunately, ",(0,r.jsx)("code",{children:"D3.js"})," has a handy ",(0,r.jsx)("code",{children:"stack()"})," ","function that does exactly that. The process is deeply explained in the ",(0,r.jsx)(u.default,{href:"stacked-area-plot",children:"stacked area chart"})," section of the gallery."]}),(0,r.jsxs)("p",{children:["The only variation required here is to use the",(0,r.jsx)("code",{children:"d3.stackOffsetSilhouette"})," offset option. Instead of stacking everything above the 0 baseline, it will put groups on both part of it."]}),(0,r.jsx)("p",{children:"Computing the position of the chart series should look something like:"}),(0,r.jsx)(d.d,{code:k})]}),(0,r.jsxs)(h.U,{title:"Most basic streamgraph",startOpen:!0,children:[(0,r.jsxs)("p",{children:["Once more, the process to render the shape is very close to the"," ",(0,r.jsx)(u.default,{href:"stacked-area-plot",children:"stacked area chart"}),". A few variations are required though."]}),(0,r.jsx)("h3",{children:"\u2192 Smoothing"}),(0,r.jsxs)("p",{children:["We need to smooth the area shape to get the good-looking organic flow. Once more d3 is here to the rescue with a"," ",(0,r.jsx)("a",{href:"https://github.com/d3/d3-shape#curves",children:"curve"})," function that does all the work for us."]}),(0,r.jsx)("h3",{children:"\u2192 Axis"}),(0,r.jsxs)("p",{children:[(0,r.jsx)(u.default,{href:"build-axis-with-react",children:"Usual axes"})," do not work for streamgraphs. The Y axis would make no sense since shapes are on both side of the 0 baseline. It is commonly"," ",(0,r.jsx)("a",{href:"https://www.dataviz-inspiration.com/stream",children:"removed"}),". The X axis would feel lost alone at the very bottom of the chart."]}),(0,r.jsx)("p",{children:"Here I suggest to replace the X axis with vertical ablines. The Y axis is removed and we will see later how"}),(0,r.jsx)(l.$,{vizName:"StreamGraphBasic",VizComponent:v,height:400,maxWidth:600,caption:"Most basic streamgraph with react and d3.js"})]}),(0,r.jsx)(w.r,{chartId:"stream"}),(0,r.jsx)(p.Z,{chartId:"stackedArea"}),(0,r.jsx)("div",{className:"full-bleed border-t h-0 bg-gray-100 my-3"}),(0,r.jsx)(a.Z,{chartFamily:"evolution"}),(0,r.jsx)("div",{className:"mt-20"}),(0,r.jsx)(c.Z,{})]})}}},function(e){e.O(0,[503,5660,358,5443,9774,2888,179],(function(){return t=8702,e(e.s=t);var t}));var t=e.O();_N_E=t}]);