(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5654],{1248:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sankey-diagram",function(){return n(4415)}])},6820:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var i=n(5893);n(7294);var r=n(8843),o=n(6438);let s=e=>{let{imgLink:t,height:n,opacity:r,children:o}=e;return(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)("div",{style:{backgroundImage:"url("+t+")",height:n,backgroundAttachment:"fixed",opacity:r,backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}}),(0,i.jsx)("div",{className:"absolute top-0 left-0 w-full h-full",children:o})]})};function a(e){var t;let{chartId:n}=e,a=(null===(t=r.c.find(e=>e.id===n))||void 0===t?void 0:t.label)||"chart";return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{id:"inspiration",children:a+" inspiration"}),(0,i.jsxs)("p",{children:["If you're looking for inspiration to create your next"," ",(0,i.jsx)("span",{children:a}),", note that"," ",(0,i.jsx)("a",{href:"https://www.dataviz-inspiration.com",children:"dataviz-inspiration.com"})," ","showcases many examples. Definitely the best place to get ... inspiration!"]}),(0,i.jsx)("div",{className:"border mb-10",children:(0,i.jsx)(s,{height:250,imgLink:"https://github.com/holtzy/dataviz-inspiration/blob/main/public/misc/overview1.png?raw=true",opacity:.3,children:(0,i.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,i.jsxs)("div",{style:{maxWidth:400},className:"flex flex-col items-center",children:[(0,i.jsxs)("p",{className:"text-center text-sm",children:[(0,i.jsx)("a",{href:"https://www.dataviz-inspiration.com",children:"dataviz-inspiration.com"})," ","showcases hundreds of stunning dataviz projects. Have a look to get some ideas on how to make your ",(0,i.jsx)("span",{children:a})," ","looks good!"]}),(0,i.jsx)(o.J,{href:"https://www.dataviz-inspiration.com",isFilled:!0,size:"md",children:"visit"})]})})})})]})}},505:function(e,t,n){"use strict";n.d(t,{r:function(){return c}});var i=n(5893),r=n(1664),o=n.n(r),s=n(8843),a=n(88),l=n(3572);let c=e=>{let{chartId:t}=e,n=s.c.filter(e=>e.id===t)[0].label;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("h2",{id:"responsiveness",children:"Responsive "+n+" with react"}),(0,i.jsxs)("p",{children:["The component above is not responsive. It expects 2 props called"," ",(0,i.jsx)("code",{children:"width"})," and ",(0,i.jsx)("code",{children:"height"})," and will render a ",n," of those dimensions."]}),(0,i.jsxs)("p",{children:["Making the ",n," responsive requires adding a ",(0,i.jsx)("b",{children:"wrapper"})," component that gets the dimension of the parent ",(0,i.jsx)("code",{children:"div"}),", and listening to a potential dimension change. This is possible thanks to a hook called"," ",(0,i.jsx)("code",{children:"useDimensions"})," that will do the job for us."]}),(0,i.jsx)(a.U,{startOpen:!1,title:(0,i.jsxs)("span",{children:[(0,i.jsx)("code",{children:"useDimensions"}),": a hook to make your viz responsive"]}),children:(0,i.jsx)(l.d,{code:d})}),(0,i.jsxs)("p",{children:["I'm in the process of writing a complete blog post on the topic."," ",(0,i.jsx)(o(),{href:"/subscribe",children:"Subscribe to the project"})," to know when it's ready."]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{})]})},d='\nexport const useDimensions = (targetRef: React.RefObject<HTMLDivElement>) => {\n\n  const getDimensions = () => {\n    return {\n      width: targetRef.current ? targetRef.current.offsetWidth : 0,\n      height: targetRef.current ? targetRef.current.offsetHeight : 0\n    };\n  };\n\n  const [dimensions, setDimensions] = useState(getDimensions);\n\n  const handleResize = () => {\n    setDimensions(getDimensions());\n  };\n\n  useEffect(() => {\n    window.addEventListener("resize", handleResize);\n    return () => window.removeEventListener("resize", handleResize);\n  }, []);\n\n  useLayoutEffect(() => {\n    handleResize();\n  }, []);\n\n  return dimensions;\n}\n'.trim()},8893:function(e,t,n){"use strict";n.d(t,{H:function(){return r}});var i=n(5893);let r=e=>{let{text:t}=e;return(0,i.jsxs)("blockquote",{className:"mt-10 opacity-20",children:[(0,i.jsx)("b",{className:"text-reactGallery mr-4",children:"ToDo"}),t]})}},4415:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Z}});var i=n(5893);n(7294);var r=n(153),o=n(9965),s=n(7262),a=n(3572),l=n(1122),c=n(6820),d=n(505),h=n(8893),u=n(6446);let f={nodes:[{node:0,name:"node0"},{node:1,name:"node1"},{node:2,name:"node2"},{node:3,name:"node3"},{node:4,name:"node4"}],links:[{source:0,target:2,value:2},{source:1,target:2,value:2},{source:1,target:3,value:2},{source:0,target:4,value:2},{source:2,target:3,value:2},{source:2,target:4,value:20},{source:3,target:4,value:4}]};function p(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let i=-1;for(let r of e)(r=+t(r,++i,e))&&(n+=r)}return n}function g(e,t){let n;if(void 0===t)for(let t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n}function x(e,t){return e.sourceLinks.length?e.depth:t-1}function m(e){return function(){return e}}function y(e,t){return v(e.source,t.source)||e.index-t.index}function j(e,t){return v(e.target,t.target)||e.index-t.index}function v(e,t){return e.y0-t.y0}function w(e){return e.value}function b(e){return e.index}function k(e){return e.nodes}function _(e){return e.links}function S(e,t){let n=e.get(t);if(!n)throw Error("missing: "+t);return n}function M({nodes:e}){for(let t of e){let e=t.y0,n=e;for(let n of t.sourceLinks)n.y0=e+n.width/2,e+=n.width;for(let e of t.targetLinks)e.y1=n+e.width/2,n+=e.width}}var D=Math.PI,z=2*D,T=z-1e-6;function L(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function A(){return new L}L.prototype=A.prototype={constructor:L,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,i){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(e,t,n,i,r,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(e,t,n,i,r){e=+e,t=+t,n=+n,i=+i,r=+r;var o=this._x1,s=this._y1,a=n-e,l=i-t,c=o-e,d=s-t,h=c*c+d*d;if(r<0)throw Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(h>1e-6){if(Math.abs(d*a-l*c)>1e-6&&r){var u=n-o,f=i-s,p=a*a+l*l,g=Math.sqrt(p),x=Math.sqrt(h),m=r*Math.tan((D-Math.acos((p+h-(u*u+f*f))/(2*g*x)))/2),y=m/x,j=m/g;Math.abs(y-1)>1e-6&&(this._+="L"+(e+y*c)+","+(t+y*d)),this._+="A"+r+","+r+",0,0,"+ +(d*u>c*f)+","+(this._x1=e+j*a)+","+(this._y1=t+j*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t)}},arc:function(e,t,n,i,r,o){e=+e,t=+t,n=+n,o=!!o;var s=n*Math.cos(i),a=n*Math.sin(i),l=e+s,c=t+a,d=1^o,h=o?i-r:r-i;if(n<0)throw Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%z+z),h>T?this._+="A"+n+","+n+",0,1,"+d+","+(e-s)+","+(t-a)+"A"+n+","+n+",0,1,"+d+","+(this._x1=l)+","+(this._y1=c):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=D)+","+d+","+(this._x1=e+n*Math.cos(r))+","+(this._y1=t+n*Math.sin(r))))},rect:function(e,t,n,i){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var E=Array.prototype.slice;function N(e){return function(){return e}}function R(e){return e[0]}function C(e){return e[1]}function P(e){return e.source}function I(e){return e.target}function W(e,t,n,i,r){e.moveTo(t,n),e.bezierCurveTo(t=(t+i)/2,n,t,r,i,r)}function G(e){return[e.source.x1,e.y0]}function V(e){return[e.target.x0,e.y1]}let O={top:10,right:30,bottom:50,left:30},q=e=>{let{width:t,height:n,data:r}=e,o=t-O.right-O.left,s=n-O.top-O.bottom,a=(function(){let e,t,n=0,i=0,r=1,o=1,s=24,a=8,l,c=b,d=x,h=k,u=_,f=6;function D(){let x={nodes:h.apply(null,arguments),links:u.apply(null,arguments)};return function({nodes:e,links:n}){for(let[t,n]of e.entries())n.index=t,n.sourceLinks=[],n.targetLinks=[];let i=new Map(e.map((t,n)=>[c(t,n,e),t]));for(let[e,t]of n.entries()){t.index=e;let{source:n,target:r}=t;"object"!=typeof n&&(n=t.source=S(i,n)),"object"!=typeof r&&(r=t.target=S(i,r)),n.sourceLinks.push(t),r.targetLinks.push(t)}if(null!=t)for(let{sourceLinks:n,targetLinks:i}of e)n.sort(t),i.sort(t)}(x),function({nodes:e}){for(let t of e)t.value=void 0===t.fixedValue?Math.max(p(t.sourceLinks,w),p(t.targetLinks,w)):t.fixedValue}(x),function({nodes:e}){let t=e.length,n=new Set(e),i=new Set,r=0;for(;n.size;){for(let e of n)for(let{target:t}of(e.depth=r,e.sourceLinks))i.add(t);if(++r>t)throw Error("circular link");n=i,i=new Set}}(x),function({nodes:e}){let t=e.length,n=new Set(e),i=new Set,r=0;for(;n.size;){for(let e of n)for(let{source:t}of(e.height=r,e.targetLinks))i.add(t);if(++r>t)throw Error("circular link");n=i,i=new Set}}(x),function(c){let h=function({nodes:t}){let i=g(t,e=>e.depth)+1,o=(r-n-s)/(i-1),a=Array(i);for(let e of t){let t=Math.max(0,Math.min(i-1,Math.floor(d.call(null,e,i))));e.layer=t,e.x0=n+t*o,e.x1=e.x0+s,a[t]?a[t].push(e):a[t]=[e]}if(e)for(let t of a)t.sort(e);return a}(c);l=Math.min(a,(o-i)/(g(h,e=>e.length)-1)),function(e){let n=function(e,t){let n;if(void 0===t)for(let t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let i=-1;for(let r of e)null!=(r=t(r,++i,e))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n}(e,e=>(o-i-(e.length-1)*l)/p(e,w));for(let r of e){let e=i;for(let t of r)for(let i of(t.y0=e,t.y1=e+t.value*n,e=t.y1+l,t.sourceLinks))i.width=i.value*n;e=(o-e+l)/(r.length+1);for(let t=0;t<r.length;++t){let n=r[t];n.y0+=e*(t+1),n.y1+=e*(t+1)}(function(e){if(void 0===t)for(let{sourceLinks:t,targetLinks:n}of e)t.sort(j),n.sort(y)})(r)}}(h);for(let t=0;t<f;++t){let n=Math.pow(.99,t),i=Math.max(1-n,(t+1)/f);(function(t,n,i){for(let r=t.length,o=r-2;o>=0;--o){let r=t[o];for(let e of r){let t=0,i=0;for(let{target:n,value:r}of e.sourceLinks){let o=r*(n.layer-e.layer);t+=function(e,t){let n=t.y0-(t.targetLinks.length-1)*l/2;for(let{source:i,width:r}of t.targetLinks){if(i===e)break;n+=r+l}for(let{target:i,width:r}of e.sourceLinks){if(i===t)break;n-=r}return n}(e,n)*o,i+=o}if(!(i>0))continue;let r=(t/i-e.y0)*n;e.y0+=r,e.y1+=r,A(e)}void 0===e&&r.sort(v),z(r,i)}})(h,n,i),function(t,n,i){for(let r=1,o=t.length;r<o;++r){let o=t[r];for(let e of o){let t=0,i=0;for(let{source:n,value:r}of e.targetLinks){let o=r*(e.layer-n.layer);t+=function(e,t){let n=e.y0-(e.sourceLinks.length-1)*l/2;for(let{target:i,width:r}of e.sourceLinks){if(i===t)break;n+=r+l}for(let{source:i,width:r}of t.targetLinks){if(i===e)break;n-=r}return n}(n,e)*o,i+=o}if(!(i>0))continue;let r=(t/i-e.y0)*n;e.y0+=r,e.y1+=r,A(e)}void 0===e&&o.sort(v),z(o,i)}}(h,n,i)}}(x),M(x),x}function z(e,t){let n=e.length>>1,r=e[n];L(e,r.y0-l,n-1,t),T(e,r.y1+l,n+1,t),L(e,o,e.length-1,t),T(e,i,0,t)}function T(e,t,n,i){for(;n<e.length;++n){let r=e[n],o=(t-r.y0)*i;o>1e-6&&(r.y0+=o,r.y1+=o),t=r.y1+l}}function L(e,t,n,i){for(;n>=0;--n){let r=e[n],o=(r.y1-t)*i;o>1e-6&&(r.y0-=o,r.y1-=o),t=r.y0-l}}function A({sourceLinks:e,targetLinks:n}){if(void 0===t){for(let{source:{sourceLinks:e}}of n)e.sort(j);for(let{target:{targetLinks:t}}of e)t.sort(y)}}return D.update=function(e){return M(e),e},D.nodeId=function(e){return arguments.length?(c="function"==typeof e?e:m(e),D):c},D.nodeAlign=function(e){return arguments.length?(d="function"==typeof e?e:m(e),D):d},D.nodeSort=function(t){return arguments.length?(e=t,D):e},D.nodeWidth=function(e){return arguments.length?(s=+e,D):s},D.nodePadding=function(e){return arguments.length?(a=l=+e,D):a},D.nodes=function(e){return arguments.length?(h="function"==typeof e?e:m(e),D):h},D.links=function(e){return arguments.length?(u="function"==typeof e?e:m(e),D):u},D.linkSort=function(e){return arguments.length?(t=e,D):t},D.size=function(e){return arguments.length?(n=i=0,r=+e[0],o=+e[1],D):[r-n,o-i]},D.extent=function(e){return arguments.length?(n=+e[0][0],r=+e[1][0],i=+e[0][1],o=+e[1][1],D):[[n,i],[r,o]]},D.iterations=function(e){return arguments.length?(f=+e,D):f},D})().nodeWidth(26).nodePadding(29).size([o,s]),{nodes:l,links:c}=a(r),d=l.map(e=>(console.log({node:e}),(0,i.jsx)("g",{children:(0,i.jsx)("rect",{height:e.y1-e.y0,width:a.nodeWidth(),x:e.x0,y:e.y0,stroke:"black",fill:"none"})},e.index))),h=c.map((e,t)=>{let n=(function(e){var t=P,n=I,i=R,r=C,o=null;function s(){var s,a=E.call(arguments),l=t.apply(this,a),c=n.apply(this,a);if(o||(o=s=A()),e(o,+i.apply(this,(a[0]=l,a)),+r.apply(this,a),+i.apply(this,(a[0]=c,a)),+r.apply(this,a)),s)return o=null,s+""||null}return s.source=function(e){return arguments.length?(t=e,s):t},s.target=function(e){return arguments.length?(n=e,s):n},s.x=function(e){return arguments.length?(i="function"==typeof e?e:N(+e),s):i},s.y=function(e){return arguments.length?(r="function"==typeof e?e:N(+e),s):r},s.context=function(e){return arguments.length?(o=null==e?null:e,s):o},s})(W).source(G).target(V),r=n(e);return console.log({path:r}),(0,i.jsx)("path",{d:r,stroke:"black",fill:"none"},t)});return(0,i.jsx)("div",{children:(0,i.jsx)("svg",{width:t,height:n,children:(0,i.jsxs)("g",{width:o,height:s,transform:"translate(".concat([O.left,O.top].join(","),")"),children:[d,h]})})})},H=e=>{let{width:t=700,height:n=400}=e;return 0===t?null:(0,i.jsx)(q,{data:f,width:t,height:n})},F=(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("p",{children:["A"," ",(0,i.jsx)("a",{href:"https://www.data-to-viz.com/graph/sankey.html",children:"Sankey Diagram"})," ","display ",(0,i.jsx)("b",{children:"flows"}),". Several entities (",(0,i.jsx)("b",{children:"nodes"}),") are represented by rectangles or text. Directed ",(0,i.jsx)("b",{children:"links"})," are represented with arrows or arcs that have a width proportional to the importance of the flow."]}),(0,i.jsxs)("p",{children:["This tutorial explains how to use ",(0,i.jsx)("code",{children:"React"}),", ",(0,i.jsx)("code",{children:"D3.js"})," ","and the ",(0,i.jsx)("code",{children:"d3-sankey"})," plugin to build a Sankey diagram. It comes with explanations and code sandboxes to play along with the suggested implementation."]})]});function Z(){return(0,i.jsxs)(r.A,{title:"How to build a Sankey Diagram with React and D3.",seoDescription:"A step-by-step guide to build your very own Sankey Diagram from scratch. Comes with explanations, code sandboxes, and ready-to-use templates.",children:[(0,i.jsx)(o.Z,{title:"Sankey Diagram",description:F,chartType:"sankey"}),(0,i.jsx)("h2",{id:"data",children:"The Data"}),(0,i.jsxs)("p",{children:["Two layers of information are required to build an arc diagram: a list of ",(0,i.jsx)("b",{children:"nodes"})," to build the rectangles and a list of ",(0,i.jsx)("b",{children:"links"})," to build the arcs."]}),(0,i.jsx)("p",{children:"Many different data structures can be used to store such information. In this tutorial I suggest to start with the following:"}),(0,i.jsx)(a.d,{code:B}),(0,i.jsxs)("p",{children:[(0,i.jsx)("code",{children:"data"})," is an object with 2 properties: ",(0,i.jsx)("code",{children:"nodes"})," and"," ",(0,i.jsx)("code",{children:"links"}),"."]}),(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:[(0,i.jsx)("code",{children:"nodes"})," is an array where each node is an object defined by its ",(0,i.jsx)("code",{children:"id"})," and its ",(0,i.jsx)("code",{children:"group"}),". Note that any other feature can be added to nodes here."]}),(0,i.jsxs)("li",{children:[(0,i.jsx)("code",{children:"links"})," is another array listing the connections. They are defined by a",(0,i.jsx)("code",{children:"source"})," and a ",(0,i.jsx)("code",{children:"target"})," and optionnaly with a ",(0,i.jsx)("code",{children:"value"}),"."]})]}),(0,i.jsx)(h.H,{text:"Explain how to build this data structure from various initial formats"}),(0,i.jsx)("h2",{id:"skeleton",children:"Component skeleton"}),(0,i.jsxs)("p",{children:["The goal here is to create a ",(0,i.jsx)("code",{children:"Sankey"})," component that will be stored in a ",(0,i.jsx)("code",{children:"Sankey.tsx"})," file. This component requires 3 props to render: a ",(0,i.jsx)("code",{children:"width"}),", a ",(0,i.jsx)("code",{children:"height"}),", and some"," ",(0,i.jsx)("code",{children:"data"}),"."]}),(0,i.jsxs)("p",{children:["The shape of the ",(0,i.jsx)("code",{children:"data"})," is described above. The"," ",(0,i.jsx)("code",{children:"width"})," and ",(0,i.jsx)("code",{children:"height"})," will be used to render an"," ",(0,i.jsx)("code",{children:"svg"})," element in the DOM, in which we will insert the Sankey."]}),(0,i.jsxs)("p",{children:["To put it in a nutshell, that's the skeleton of our ",(0,i.jsx)("code",{children:"Sankey"})," ","component:"]}),(0,i.jsx)(a.d,{code:J}),(0,i.jsxs)("p",{children:["It's fundamental to understand that with this code organization, d3.js will be used to prepare the SVG ",(0,i.jsx)("code",{children:"circle"}),", but it's React that will render them in the ",(0,i.jsx)("code",{children:"return()"})," statement. We won't use d3 methods like ",(0,i.jsx)("code",{children:"append"})," that you can find in usual"," ",(0,i.jsx)("a",{href:"https://www.d3-graph-gallery.com",children:"d3.js examples"}),"."]}),(0,i.jsx)("h2",{id:"Nodes",children:"Draw the nodes"}),(0,i.jsxs)("p",{children:["Positionning the nodes relies on a"," ",(0,i.jsx)("a",{href:"https://github.com/d3/d3-scale#scalePoint",children:"point scale"})," ","implement in the ",(0,i.jsx)("code",{children:"scalePoint()"})," function of d3."]}),(0,i.jsxs)("p",{children:["The ",(0,i.jsx)("code",{children:"group"})," property of each node can be used to create an categoric color scale."]}),(0,i.jsxs)("p",{children:["Once the scales are available, it is just a matter of looping through all nodes and render them with several ",(0,i.jsx)("code",{children:"circle"})," SVG elements."]}),(0,i.jsx)(a.d,{code:U}),(0,i.jsx)("p",{children:"Resulting in a few dots being the basis of our ongoing arc diagram \uD83D\uDD25."}),(0,i.jsx)(l.$,{VizComponent:H,vizName:"SankeyDiagramBasic",maxWidth:500,height:500,caption:"First step of our ongoing arc diagram: the nodes are displayed at the bottom of the figure."}),(0,i.jsx)("h2",{id:"connections",children:"Draw the connections"}),(0,i.jsxs)("p",{children:["We now have to draw the ",(0,i.jsx)("b",{children:"connections"})," between nodes using"," ",(0,i.jsx)("b",{children:"arcs"}),". All the connections are listed in the ",(0,i.jsx)("b",{children:"links"})," property of the dataset. So it is just a matter of looping through them and draw some SVG for each."]}),(0,i.jsxs)("p",{children:["Drawing an arc in SVG can be done using a ",(0,i.jsx)("code",{children:"path"})," element."," "]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#path_commands",children:"Six types"})," ","of ",(0,i.jsx)("code",{children:"path"})," commands exist. The one we need here is the"," ",(0,i.jsx)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d#elliptical_arc_curve",children:"Elliptical Arc Curve"}),". Its syntax is a bit complicated but here is a function that will get the ",(0,i.jsx)("code",{children:"d"})," attribute of the path we need from the coordinates of 2 points:"]}),(0,i.jsx)(a.d,{code:X}),(0,i.jsxs)("p",{children:["We can call this function for each link and pass the result to a"," ",(0,i.jsx)("code",{children:"path"}),"element. It results in our first basic arc diagram \uD83D\uDE0B"]}),(0,i.jsx)(l.$,{VizComponent:u.J,vizName:"ArcDiagramBasic",maxWidth:500,height:300,caption:"Add arcs using a custom functionn that draws some elliptical arc curve in SVG."}),(0,i.jsx)(d.r,{chartId:"sankey"}),(0,i.jsx)(c.Z,{chartId:"sankey"}),(0,i.jsx)("div",{className:"full-bleed border-t h-0 bg-gray-100 mb-3 mt-24"}),(0,i.jsx)(s.Z,{chartFamily:"distribution"}),(0,i.jsx)("div",{className:"mt-20"})]})}let B='\nexport const data = {\n  nodes: [\n      { id: "Myriel", group: \'team1\' },\n      { id: "Anne", group: \'team1\' },\n      ...\n  ],\n  links: [\n      { source: "Anne", target: "Myriel", value: 1 },\n      { source: "Napoleon", target: "Myriel", value: 1 },\n      ...\n  ]\n}\n'.trim(),J='\nimport * as d3 from "d3"; // we will need d3.js\n\ntype SankeyProps = {\n  width: number;\n  height: number;\n  data: number[];\n};\n\nexport const Sankey = ({ width, height, data }: SankeyProps) => {\n\n  // read the data\n  // create a color scale for the nodes\n  // compute node position thanks to the d3.sankey() function\n  // build the rectangles and arcs\n\n  return (\n    <div>\n      <svg width={width} height={height}>\n        // render all the <rect> and <path>\n      </svg>\n    </div>\n  );\n};\n'.trim(),U="\nconst xScale = d3.scalePoint().range([0, boundsWidth]).domain(allNodeNames);\n\nconst colorScale = d3\n  .scaleOrdinal<string>()\n  .domain(allNodeGroups)\n  .range(COLORS);\n\nconst allNodes = data.nodes.map((node) => {\n  return (\n    <circle\n      key={node.id}\n      cx={xScale(node.id)}\n      cy={boundsHeight}\n      r={8}\n      fill={colorScale(node.group)}\n    />\n  );\n});\n".trim(),X='\nconst horizontalArcGenerator = (\n  xStart,\n  yStart,\n  xEnd,\n  yEnd\n) => {\n  return [\n    // the arc starts at the coordinate xStart, xEnd\n    "M",\n    xStart,\n    yStart,\n\n    // A means we\'re gonna build an Elliptical Arc Curve\n    "A",\n    (xStart - xEnd) / 2,    // rx: first radii of the ellipse (inflexion point)\n    (xStart - xEnd) / 2,    // ry: second radii of the ellipse  (inflexion point)\n    0,                      // angle: rotation (in degrees) of the ellipse relative to the x-axis\n    1,                      // large-arc-flag: large arc (1) or small arc (0)\n    xStart < xEnd ? 1 : 0,  // sweep-flag: the clockwise turning arc (1) or counterclockwise turning arc (0)\n\n    // Position of the end of the arc\n    xEnd,\n    ",",\n    yEnd,\n  ].join(" ");\n};\n'.trim()},6446:function(e,t,n){"use strict";n.d(t,{J:function(){return d}});var i=n(5893);let r={nodes:[{id:"Myriel",group:"team1"},{id:"Anne",group:"team1"},{id:"Gabriel",group:"team1"},{id:"Mel",group:"team1"},{id:"Yan",group:"team2"},{id:"Tom",group:"team2"},{id:"Cyril",group:"team2"},{id:"Tuck",group:"team2"},{id:"Antoine",group:"team3"},{id:"Rob",group:"team3"}],links:[{source:"Anne",target:"Myriel",value:1},{source:"Napoleon",target:"Myriel",value:1},{source:"Gabriel",target:"Myriel",value:1},{source:"Mel",target:"Myriel",value:1},{source:"Yan",target:"Tom",value:1},{source:"Tom",target:"Cyril",value:1},{source:"Tuck",target:"Myriel",value:1},{source:"Tuck",target:"Mel",value:1},{source:"Tuck",target:"Myriel",value:1},{source:"Mel",target:"Myriel",value:1},{source:"Rob",target:"Antoine",value:1}]};var o=n(2600);let s=["#e0ac2b","#e85252","#6689c6","#9a6fb0","#a53253"],a={top:10,right:30,bottom:50,left:30},l=e=>{let{width:t,height:n,data:r}=e,l=t-a.right-a.left,d=n-a.top-a.bottom,h=r.nodes.map(e=>e.id),u=[...new Set(r.nodes.map(e=>e.group))],f=o.q2y().range([0,l]).domain(h),p=o.PKp().domain(u).range(s),g=r.nodes.map(e=>(0,i.jsx)("circle",{cx:f(e.id),cy:d,r:8,fill:p(e.group)},e.id)),x=r.links.map((e,t)=>{let n=f(e.source),r=f(e.target);if(void 0!==n&&void 0!==r)return(0,i.jsx)("path",{d:c(n,d,r,d),stroke:"black",fill:"none"},t)});return(0,i.jsx)("div",{children:(0,i.jsx)("svg",{width:t,height:n,children:(0,i.jsxs)("g",{width:l,height:d,transform:"translate(".concat([a.left,a.top].join(","),")"),children:[g,x]})})})},c=(e,t,n,i)=>["M",e,t,"A",(e-n)/2,(e-n)/2,0,1,e<n?1:0,n,",",i].join(" "),d=e=>{let{width:t=700,height:n=400}=e;return 0===t?null:(0,i.jsx)(l,{data:r,width:t,height:n})}}},function(e){e.O(0,[3996,2600,5660,645,1188,9774,2888,179],function(){return e(e.s=1248)}),_N_E=e.O()}]);